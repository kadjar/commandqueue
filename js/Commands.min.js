(function(){Command=Class.extend({init:function(e,t,n){this.ctxt=e;this.method=t;this.args=n}});CommandQueue=Class.extend({init:function(){this.stack=[];this.running=false;this.onComplete=null}});var e=CommandQueue.prototype;e.start=function(e){if(e)this.onComplete=e;var t=this.stack.pop();var n=this;this.running==false;if(t){this.running=true;this._runCommand(t).then(function(){n.start()})}else{if(this.onComplete)this.onComplete();this.running=false}};e.add=function(e){this.stack.unshift(e)};e._runCommand=function(e){var t=new j.Deferred;if(e.args)e.args=Object.prototype.toString.apply(e.args)==="[object Array]"?e.args:[e.args];else e.args=[];e.args.push(t.resolve);e.method.apply(e.context,e.args);return t.promise()};e.clear=function(){this.stack=[];this.onComplete=null;this.start()}})()